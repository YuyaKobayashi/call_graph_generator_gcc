# Dynamic Code Graph Generator for gcc

## Overview
This is a Dynamic Code Graph Generator(DCGG) for programs that is compiled with gcc/g++.
You can easily generate a call graph with a few steps.
This supports a multi-thread application.


It takes three steps to create a call graph image.
 1. run your program and obtain histroies of function callings (with libcall\_tracer.so).
 2. convert the histories to a .dot file (with func\_hist2dot).
 3. convert the .dot file to some image (with Graphviz).

## Prerequirement
 - Graphviz
 - gnu compiler suporting C++11 (4.3 or later)

## How to use
The following explains how to use DCGG tools.
In the below, `DCGG$` and `PROJECT$` indicate that the current directory where you publish the command is of DCGG and your project respectively.


 1. build DCGG tools.
 ```bash
 DCGG$ make 
 ```
 2. build your program with `-finstrument-functions`, `-rdynamic` and `-g` options
 ```bash
 PROJECT$ gcc -finstrument-functions -rdynamic -g -o main main.c
 ```
 3. run your program with `LD_PRELOAD=path/to/libcall_tracer.so`
 ```bash
 PROJECT$ LD_PRELOAD=path/to/libcall_tracer.so ./main
 PROJECT$ ls func_hist.*
 func_hist.25549_25549 func_hist.25549_25550 func_hist.25549_25551 #These are generated by libcall_tracer.so
 ```
 4. generate .dot files by passing func\_hist.\* files to func\_hist2dot
 ```bash
 PROJECT$ path/to/func_hist2dot func_hist.*
 PROJECT$ ls call_graph.dot
 call_graph.dot
 ```
 5. create an image of the call graph with Graphviz
 ```bash
 PROJECT$ dot call_graph.dot -Tjpg call_graph.jpeg
 PROJECT$ ls call_graph.jpeg
 call_graph.jpeg
 ```
